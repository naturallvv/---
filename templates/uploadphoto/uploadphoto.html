{% load static %}
<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="{% static 'uploadphoto/css/globals.css' %}" />
    <link rel="stylesheet" href="{% static 'uploadphoto/css/style.css' %}" />
    <title>Upload Photo</title>
    <style>
      /* .share 클래스에 정의된 위치 스타일은 style.css에서 관리됩니다.
         미리보기 이미지(#preview) 기본 상태는 숨김 처리합니다. */
      #preview.share {
        display: none;
        max-width: 500px;
        margin: 20px auto;
      }
      /* label 스타일: 커서 변경 등 */
      label.upload-your-photo {
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div class="recommend">
      <div class="div">
        <div class="overlap">
          <header class="header">
            <div class="text-wrapper">여기 옵서</div>
            <div class="explain">
              <div class="overlap-group">
                <div class="text-wrapper-2">Explain</div>
              </div>
            </div>
            <!-- Home 클릭 시 main 페이지로 이동 -->
            <div class="home">
              <a href="{% url 'main_page' %}" style="display: block; text-decoration: none; color: inherit;">
                <div class="div-wrapper">
                  <div class="text-wrapper-3">Home</div>
                </div>
              </a>
            </div>
            <!-- Search 클릭 시 uploadphoto 페이지로 이동 -->
            <div class="search">
              <a href="{% url 'uploadphoto_page' %}" style="display: block; text-decoration: none; color: inherit;">
                <div class="overlap-2">
                  <div class="rectangle"></div>
                  <input class="input" placeholder="Search" type="text" disabled
                         style="pointer-events: none; background: none; border: none;"/>
                </div>
              </a>
            </div>
            <div class="contents">
              <div class="contents-wrapper">
                <div class="contents-2">Contents</div>
              </div>
            </div>
            <div class="workers">
              <div class="overlap-3">
                <div class="rectangle-2"></div>
                <div class="workers-2">Workers</div>
              </div>
            </div>
            <div class="login">
              <div class="overlap-4">
                <div class="text-wrapper-4">로그인</div>
              </div>
            </div>
          </header>
        </div>
        <div class="overlap-5">
          <!-- 업로드 폼 영역 -->
          <form id="uploadForm" method="POST" enctype="multipart/form-data" style="text-align: center;">
            {% csrf_token %}
            <!-- 숨겨진 파일 입력; 파일 선택 시 previewFile() 호출 -->
            <input type="file" name="image" id="photo" accept="image/*" style="display: none;"
                    onchange="previewFile()" required />
            <!-- label 클릭 시 파일 선택창이 열림 -->
            <label for="photo" class="upload-your-photo" style="cursor: pointer;">
              Upload Your Photo
            </label>
          </form>
          <!-- 업로드된 사진 미리보기가 .share 스타일에 의해 지정된 위치에 나타남 -->
          <img id="preview" class="share" src="#" alt="Uploaded Photo" />
          <!-- 원래 있던 share 아이콘은 여기서는 필요 없으므로 display: none 처리 -->
          <img class="share" src="{% static 'uploadphoto/img/share.svg' %}" alt="Share" style="display: none;" />
        </div>
        <div class="upload-your-travel">
          Upload Your <br />travel Photo
        </div>
        <div class="text-wrapper-5">please submit your photos</div>
        <div class="text-wrapper-6">choice your travel yourself</div>
        <p class="p">drag and drop your photo</p>
        <img class="img" src="{% static 'uploadphoto/image/img2.jpg' %}" alt="Rect33" />
        <img class="rectangle-3" src="{% static 'uploadphoto/image/img3.jpg' %}" alt="Rect34" />
        <img class="rectangle-4" src="{% static 'uploadphoto/image/img4.jpg' %}" alt="Rect35" />
        <img class="rectangle-5" src="{% static 'uploadphoto/image/img5.jpg' %}" alt="Rect36" />
      </div>
    </div>
    <script>
      function previewFile() {
        const preview = document.getElementById('preview');
        const fileInput = document.getElementById('photo');
        const file = fileInput.files[0];
        const reader = new FileReader();
  
        reader.onloadend = function () {
          preview.src = reader.result;
          preview.style.display = 'block';
          // 파일 미리보기가 표시된 후 1초 후 자동으로 폼 제출
          setTimeout(() => {
            document.getElementById('uploadForm').submit();
          }, 1000);
        }
  
        if (file) {
          reader.readAsDataURL(file);
        } else {
          preview.src = "";
          preview.style.display = 'none';
        }
      }
    </script>
  </body>
</html>
